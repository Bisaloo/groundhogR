#' Get package search path
#'
#' Determine paths to search for an already installed package (versions of same
#' minor, in reverse chronological order).
#'
#' @inheritParams get.dependencies
#' @param vrs character. Version of the package to install.
#'
#' @return the path where the package from a specific version is/will be
#'   installed.
#'
#' @examples
#' \donttest{
#' groundhogR:::get.pkg_search_paths("magrittr", "1.0.1")
#' }
#'
get.pkg_search_paths <- function(pkg, vrs) {
  # R versions
  R.toc <- toc("R")

  R_vrs <- do.call(rbind.data.frame, strsplit(R.toc$Version, ".", fixed = TRUE))
  names(R_vrs) <- c("major", "minor", "patch")

  R.toc <- cbind(R.toc, R_vrs)

  R.toc$Published <- as.DateYMD(R.toc$Published)

  # Subset of R.toc for same minor as r.using
  rv <- r.version.check("2019-01-01") # use arbitrary date for we don't use 'r.need', just r.using
  subset.R.toc <- R.toc[R.toc$minor == rv$r.using.minor &
    R.toc$major == rv$r.using.major &
    R.toc$Published <= get.rdate(), ]

  # Sort versions from most recent
  subset.R.toc <- subset.R.toc[order(subset.R.toc$Published, decreasing = TRUE), ]

  # paths
  pkg_search_paths <- paste0(get.groundhog.folder(), "/R-", subset.R.toc$Version, "/", pkg, "_", vrs)

  # Ensure directories exist
  return(pkg_search_paths)
}
